---
const pathname = Astro.url.pathname;
---

<nav
    class="bg-primary-100 border-b sticky top-0 z-50 transition-colors duration-300"
    id="navbar"
>
    <div class="max-w-6xl mx-auto px-6 md:px-8">
        <div class="flex items-center justify-between h-16">
            <a
                href={`${import.meta.env.BASE_URL}`}
                class="text-xl font-bold text-gray-900 hover:text-primary-600 transition-colors"
            >
                Oskar Villa
            </a>

            <!-- Desktop Navigation -->
            <div class="hidden md:flex gap-8">
                <a
                    href={`${import.meta.env.BASE_URL}#projects`}
                    class="text-gray-600 hover:text-primary-600 font-medium transition-colors"
                >
                    Projects
                </a>
                <a
                    href={`${import.meta.env.BASE_URL}#experience`}
                    class="text-gray-600 hover:text-primary-600 font-medium transition-colors"
                >
                    Experience
                </a>
                <a
                    href={`${import.meta.env.BASE_URL}#contact`}
                    class="text-gray-600 hover:text-primary-600 font-medium transition-colors"
                >
                    Contact
                </a>
            </div>

            <!-- Mobile Menu Button -->
            <button
                id="mobile-menu-button"
                class="md:hidden p-2 text-gray-600 hover:text-primary-600 focus:outline-none"
                aria-label="Toggle menu"
            >
                <svg
                    class="w-6 h-6"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </div>

        <!-- Mobile Navigation -->
        <div id="mobile-menu" class="hidden md:hidden pb-4">
            <div class="flex flex-col space-y-3">
                <a
                    href={`${import.meta.env.BASE_URL}#projects`}
                    class="text-gray-600 hover:text-primary-600 font-medium transition-colors py-2"
                >
                    Projects
                </a>
                <a
                    href={`${import.meta.env.BASE_URL}#experience`}
                    class="text-gray-600 hover:text-primary-600 font-medium transition-colors py-2"
                >
                    Experience
                </a>
                <a
                    href={`${import.meta.env.BASE_URL}#contact`}
                    class="text-gray-600 hover:text-primary-600 font-medium transition-colors py-2"
                >
                    Contact
                </a>
            </div>
        </div>
    </div>
</nav>

<script>
    const button = document.getElementById('mobile-menu-button');
    const menu = document.getElementById('mobile-menu');
    const navbar = document.getElementById('navbar');

    button?.addEventListener('click', () => {
        menu?.classList.toggle('hidden');
    });

    // Close menu when clicking a link
    menu?.querySelectorAll('a').forEach((link) => {
        link.addEventListener('click', () => {
            menu?.classList.add('hidden');
        });
    });

    // Change navbar color on scroll - smooth gradient transition
    window.addEventListener('scroll', () => {
        const scrollPosition = window.scrollY;
        const heroHeight = 500; // Adjust this to match your hero section height

        if (scrollPosition > heroHeight) {
            navbar?.classList.remove(
                'bg-primary-100',
                'border-primary-200',
                'border-transparent'
            );
            navbar?.classList.add('bg-white', 'border-gray-200');
            if (navbar) {
                navbar.style.backgroundColor = '';
                navbar.style.borderColor = '';
            }
        } else {
            navbar?.classList.remove('bg-white', 'border-gray-200');
            navbar?.classList.add('border-transparent');

            // Calculate gradient position (0 to 1)
            const gradientPosition = scrollPosition / heroHeight;

            // Interpolate between primary-100 (rgb(224, 242, 254)) and white (rgb(255, 255, 255))
            const r = Math.round(224 + (255 - 224) * gradientPosition);
            const g = Math.round(242 + (255 - 242) * gradientPosition);
            const b = Math.round(254 + (255 - 254) * gradientPosition);

            if (navbar) {
                navbar.style.backgroundColor = `rgb(${r}, ${g}, ${b})`;
            }
        }
    });
</script>
